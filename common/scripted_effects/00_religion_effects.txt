# add_sympathy_for_prevs_true_religion_effect
# add_sympathy_for_prevs_open_religion_effect
# flip_to_secret_religion_effect
# flip_secret_religious_community_provinces
# flip_all_realm_secret_religious_community_provinces
# root_secret_religion_provinces_convert_effect
# reset_religion_features_effect
# apply_cosmopolian_on_start_effect
# apply_dogmatic_on_start_effect
# reformation_god_names_changes_effect
# convert_religion_failsafe_effect
# abdicate_all_primary_type_titles_effect

add_sympathy_for_prevs_true_religion_effect = {
	if = {
		limit = {
			PREV = { true_religion_group = christian }
			NOT = { religion_group = christian }
		}
		add_trait = sympathy_christendom
	}
	else_if = {
		limit = {
			PREV = { true_religion_group = muslim }
			NOT = { religion_group = muslim }
		}
		add_trait = sympathy_islam
	}
	else_if = {
		limit = {
			PREV = { true_religion_group = pagan_group }
			NOT = { religion_group = pagan_group }
		}
		add_trait = sympathy_pagans
	}
	else_if = {
		limit = {
			PREV = { true_religion_group = zoroastrian_group }
			NOT = { religion_group = zoroastrian_group }
		}
		add_trait = sympathy_zoroastrianism
	}
	else_if = {
		limit = {
			PREV = { true_religion_group = jewish_group }
			NOT = { religion_group = jewish_group }
		}
		add_trait = sympathy_judaism
	}
	else_if = {
		limit = {
			PREV = { true_religion_group = indian_group }
			NOT = { religion_group = indian_group }
		}
		add_trait = sympathy_indian
	}
}

add_sympathy_for_prevs_open_religion_effect = {
	if = {
		limit = {
			PREV = { religion_group = christian }
			NOT = { religion_group = christian }
		}
		add_trait = sympathy_christendom
	}
	else_if = {
		limit = {
			PREV = { religion_group = muslim }
			NOT = { religion_group = muslim }
		}
		add_trait = sympathy_islam
	}
	else_if = {
		limit = {
			PREV = { religion_group = pagan_group }
			NOT = { religion_group = pagan_group }
		}
		add_trait = sympathy_pagans
	}
	else_if = {
		limit = {
			PREV = { religion_group = zoroastrian_group }
			NOT = { religion_group = zoroastrian_group }
		}
		add_trait = sympathy_zoroastrianism
	}
	else_if = {
		limit = {
			PREV = { religion_group = jewish_group }
			NOT = { religion_group = jewish_group }
		}
		add_trait = sympathy_judaism
	}
	else_if = {
		limit = {
			PREV = { religion_group = indian_group }
			NOT = { religion_group = indian_group }
		}
		add_trait = sympathy_indian
	}
}

# TODO: Rework with persistent_event_target (religion scope). Currently unused
flip_secret_religious_community_provinces = {
	trigger_switch = {
		on_trigger = secret_religion

		catholic = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_catholic_community
						owned_by = PREV
					}

					religion = catholic
					remove_province_modifier = secret_catholic_community
				}
			}
		}

		cathar = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_cathar_community
						owned_by = PREV
					}

					religion = cathar
					remove_province_modifier = secret_cathar_community
				}
			}
		}

		fraticelli = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_fraticelli_community
						owned_by = PREV
					}

					religion = fraticelli
					remove_province_modifier = secret_fraticelli_community
				}
			}
		}

		waldensian = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_waldensian_community
						owned_by = PREV
					}

					religion = waldensian
					remove_province_modifier = secret_waldensian_community
				}
			}
		}

		lollard = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_lollard_community
						owned_by = PREV
					}

					religion = lollard
					remove_province_modifier = secret_lollard_community
				}
			}
		}

		orthodox = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_orthodox_community
						owned_by = PREV
					}

					religion = orthodox
					remove_province_modifier = secret_orthodox_community
				}
			}
		}

		miaphysite = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_miaphysite_community
						owned_by = PREV
					}

					religion = miaphysite
					remove_province_modifier = secret_miaphysite_community
				}
			}
		}

		monophysite = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_monophysite_community
						owned_by = PREV
					}

					religion = monophysite
					remove_province_modifier = secret_monophysite_community
				}
			}
		}

		bogomilist = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_bogomilist_community
						owned_by = PREV
					}

					religion = bogomilist
					remove_province_modifier = secret_bogomilist_community
				}
			}
		}

		monothelite = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_monothelite_community
						owned_by = PREV
					}

					religion = monothelite
					remove_province_modifier = secret_monothelite_community
				}
			}
		}

		iconoclast = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_iconoclast_community
						owned_by = PREV
					}

					religion = iconoclast
					remove_province_modifier = secret_iconoclast_community
				}
			}
		}

		paulician = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_paulician_community
						owned_by = PREV
					}

					religion = paulician
					remove_province_modifier = secret_paulician_community
				}
			}
		}

		nestorian = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_nestorian_community
						owned_by = PREV
					}

					religion = nestorian
					remove_province_modifier = secret_nestorian_community
				}
			}
		}

		messalian = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_messalian_community
						owned_by = PREV
					}

					religion = messalian
					remove_province_modifier = secret_messalian_community
				}
			}
		}

		sunni = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_sunni_community
						owned_by = PREV
					}

					religion = sunni
					remove_province_modifier = secret_sunni_community
				}
			}
		}

		zikri = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_zikri_community
						owned_by = PREV
					}

					religion = zikri
					remove_province_modifier = secret_zikri_community
				}
			}
		}

		yazidi = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_yazidi_community
						owned_by = PREV
					}

					religion = yazidi
					remove_province_modifier = secret_yazidi_community
				}
			}
		}

		ibadi = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_ibadi_community
						owned_by = PREV
					}

					religion = ibadi
					remove_province_modifier = secret_ibadi_community
				}
			}
		}

		kharijite = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_kharijite_community
						owned_by = PREV
					}

					religion = kharijite
					remove_province_modifier = secret_kharijite_community
				}
			}
		}

		shiite = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_shiite_community
						owned_by = PREV
					}

					religion = shiite
					remove_province_modifier = secret_shiite_community
				}
			}
		}

		druze = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_druze_community
						owned_by = PREV
					}

					religion = druze
					remove_province_modifier = secret_druze_community
				}
			}
		}

		hurufi = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_hurufi_community
						owned_by = PREV
					}

					religion = hurufi
					remove_province_modifier = secret_hurufi_community
				}
			}
		}

		qarmatian = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_qarmatian_community
						owned_by = PREV
					}

					religion = qarmatian
					remove_province_modifier = secret_qarmatian_community
				}
			}
		}

		jewish = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_jewish_community
						owned_by = PREV
					}

					religion = jewish
					remove_province_modifier = secret_jewish_community
				}
			}
		}

		karaite = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_karaite_community
						owned_by = PREV
					}

					religion = karaite
					remove_province_modifier = secret_karaite_community
				}
			}
		}

		samaritan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_samaritan_community
						owned_by = PREV
					}

					religion = samaritan
					remove_province_modifier = secret_samaritan_community
				}
			}
		}

		zoroastrian = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_zoroastrian_community
						owned_by = PREV
					}

					religion = zoroastrian
					remove_province_modifier = secret_zoroastrian_community
				}
			}
		}

		mazdaki = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_mazdaki_community
						owned_by = PREV
					}

					religion = mazdaki
					remove_province_modifier = secret_mazdaki_community
				}
			}
		}

		manichaean = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_manichaean_community
						owned_by = PREV
					}

					religion = manichaean
					remove_province_modifier = secret_manichaean_community
				}
			}
		}

		khurmazta = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_khurmazta_community
						owned_by = PREV
					}

					religion = khurmazta
					remove_province_modifier = secret_khurmazta_community
				}
			}
		}

		bon_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_bon_pagan_community
						owned_by = PREV
					}

					religion = bon_pagan
					remove_province_modifier = secret_bon_pagan_community
				}
			}
		}

		bon_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_bon_pagan_reformed_community
						owned_by = PREV
					}

					religion = bon_pagan_reformed
					remove_province_modifier = secret_bon_pagan_reformed_community
				}
			}
		}

		hellenic_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_hellenic_pagan_community
						owned_by = PREV
					}

					religion = hellenic_pagan
					remove_province_modifier = secret_hellenic_pagan_community
				}
			}
		}

		hellenic_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_hellenic_pagan_reformed_community
						owned_by = PREV
					}

					religion = hellenic_pagan_reformed
					remove_province_modifier = secret_hellenic_pagan_reformed_community
				}
			}
		}

		taoist = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_taoist_community
						owned_by = PREV
					}

					religion = taoist
					remove_province_modifier = secret_taoist_community
				}
			}
		}

		hindu = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_hindu_community
						owned_by = PREV
					}

					religion = hindu
					remove_province_modifier = secret_hindu_community
				}
			}
		}

		buddhist = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_buddhist_community
						owned_by = PREV
					}

					religion = buddhist
					remove_province_modifier = secret_buddhist_community
				}
			}
		}

		jain = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_jain_community
						owned_by = PREV
					}

					religion = jain
					remove_province_modifier = secret_jain_community
				}
			}
		}

		norse_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_norse_pagan_reformed_community
						owned_by = PREV
					}

					religion = norse_pagan_reformed
					remove_province_modifier = secret_norse_pagan_reformed_community
				}
			}
		}

		norse_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_norse_pagan_community
						owned_by = PREV
					}

					religion = norse_pagan
					remove_province_modifier = secret_norse_pagan_community
				}
			}
		}

		slavic_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_slavic_pagan_reformed_community
						owned_by = PREV
					}

					religion = slavic_pagan_reformed
					remove_province_modifier = secret_slavic_pagan_reformed_community
				}
			}
		}

		slavic_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_slavic_pagan_community
						owned_by = PREV
					}

					religion = slavic_pagan
					remove_province_modifier = secret_slavic_pagan_community
				}
			}
		}

		tengri_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_tengri_pagan_reformed_community
						owned_by = PREV
					}

					religion = tengri_pagan_reformed
					remove_province_modifier = secret_tengri_pagan_reformed_community
				}
			}
		}

		tengri_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_tengri_pagan_community
						owned_by = PREV
					}

					religion = tengri_pagan
					remove_province_modifier = secret_tengri_pagan_community
				}
			}
		}

		baltic_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_baltic_pagan_reformed_community
						owned_by = PREV
					}

					religion = baltic_pagan_reformed
					remove_province_modifier = secret_baltic_pagan_reformed_community
				}
			}
		}

		baltic_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_baltic_pagan_community
						owned_by = PREV
					}

					religion = baltic_pagan
					remove_province_modifier = secret_baltic_pagan_community
				}
			}
		}

		finnish_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_finnish_pagan_reformed_community
						owned_by = PREV
					}

					religion = finnish_pagan_reformed
					remove_province_modifier = secret_finnish_pagan_reformed_community
				}
			}
		}

		finnish_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_finnish_pagan_community
						owned_by = PREV
					}

					religion = finnish_pagan
					remove_province_modifier = secret_finnish_pagan_community
				}
			}
		}

		west_african_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_west_african_pagan_reformed_community
						owned_by = PREV
					}

					religion = west_african_pagan_reformed
					remove_province_modifier = secret_west_african_pagan_reformed_community
				}
			}
		}

		west_african_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_west_african_pagan_community
						owned_by = PREV
					}

					religion = west_african_pagan
					remove_province_modifier = secret_west_african_pagan_community
				}
			}
		}

		zun_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_zun_pagan_reformed_community
						owned_by = PREV
					}

					religion = zun_pagan_reformed
					remove_province_modifier = secret_zun_pagan_reformed_community
				}
			}
		}

		zun_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_zun_pagan_community
						owned_by = PREV
					}

					religion = zun_pagan
					remove_province_modifier = secret_zun_pagan_community
				}
			}
		}

		aztec_pagan = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_aztec_pagan_community
						owned_by = PREV
					}

					religion = aztec_pagan
					remove_province_modifier = secret_aztec_pagan_community
				}
			}
		}

		aztec_pagan_reformed = {
			ROOT = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_aztec_pagan_reformed_community
						owned_by = PREV
					}

					religion = aztec_pagan_reformed
					remove_province_modifier = secret_aztec_pagan_reformed_community
				}
			}
		}
	}
}

flip_all_realm_secret_religious_community_provinces = {
	trigger_switch = {
		on_trigger = secret_religion

		catholic = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_catholic_community
						held_under_PREV = yes
					}

					religion = catholic
					remove_province_modifier = secret_catholic_community
				}
			}
		}

		cathar = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_cathar_community
						held_under_PREV = yes
					}

					religion = cathar
					remove_province_modifier = secret_cathar_community
				}
			}
		}

		fraticelli = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_fraticelli_community
						held_under_PREV = yes
					}

					religion = fraticelli
					remove_province_modifier = secret_fraticelli_community
				}
			}
		}

		waldensian = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_waldensian_community
						held_under_PREV = yes
					}

					religion = waldensian
					remove_province_modifier = secret_waldensian_community
				}
			}
		}

		lollard = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_lollard_community
						held_under_PREV = yes
					}

					religion = lollard
					remove_province_modifier = secret_lollard_community
				}
			}
		}

		orthodox = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_orthodox_community
						held_under_PREV = yes
					}

					religion = orthodox
					remove_province_modifier = secret_orthodox_community
				}
			}
		}

		miaphysite = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_miaphysite_community
						held_under_PREV = yes
					}

					religion = miaphysite
					remove_province_modifier = secret_miaphysite_community
				}
			}
		}

		monophysite = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_monophysite_community
						held_under_PREV = yes
					}

					religion = monophysite
					remove_province_modifier = secret_monophysite_community
				}
			}
		}

		bogomilist = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_bogomilist_community
						held_under_PREV = yes
					}

					religion = bogomilist
					remove_province_modifier = secret_bogomilist_community
				}
			}
		}

		monothelite = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_monothelite_community
						held_under_PREV = yes
					}

					religion = monothelite
					remove_province_modifier = secret_monothelite_community
				}
			}
		}

		iconoclast = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_iconoclast_community
						held_under_PREV = yes
					}

					religion = iconoclast
					remove_province_modifier = secret_iconoclast_community
				}
			}
		}

		paulician = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_paulician_community
						held_under_PREV = yes
					}

					religion = paulician
					remove_province_modifier = secret_paulician_community
				}
			}
		}

		nestorian = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_nestorian_community
						held_under_PREV = yes
					}

					religion = nestorian
					remove_province_modifier = secret_nestorian_community
				}
			}
		}

		messalian = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_messalian_community
						held_under_PREV = yes
					}

					religion = messalian
					remove_province_modifier = secret_messalian_community
				}
			}
		}

		sunni = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_sunni_community
						held_under_PREV = yes
					}

					religion = sunni
					remove_province_modifier = secret_sunni_community
				}
			}
		}

		zikri = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_zikri_community
						held_under_PREV = yes
					}

					religion = zikri
					remove_province_modifier = secret_zikri_community
				}
			}
		}

		yazidi = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_yazidi_community
						held_under_PREV = yes
					}

					religion = yazidi
					remove_province_modifier = secret_yazidi_community
				}
			}
		}

		ibadi = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_ibadi_community
						held_under_PREV = yes
					}

					religion = ibadi
					remove_province_modifier = secret_ibadi_community
				}
			}
		}

		kharijite = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_kharijite_community
						held_under_PREV = yes
					}

					religion = kharijite
					remove_province_modifier = secret_kharijite_community
				}
			}
		}

		shiite = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_shiite_community
						held_under_PREV = yes
					}

					religion = shiite
					remove_province_modifier = secret_shiite_community
				}
			}
		}

		druze = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_druze_community
						held_under_PREV = yes
					}

					religion = druze
					remove_province_modifier = secret_druze_community
				}
			}
		}

		hurufi = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_hurufi_community
						held_under_PREV = yes
					}

					religion = hurufi
					remove_province_modifier = secret_hurufi_community
				}
			}
		}

		qarmatian = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_qarmatian_community
						held_under_PREV = yes
					}

					religion = qarmatian
					remove_province_modifier = secret_qarmatian_community
				}
			}
		}

		jewish = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_jewish_community
						held_under_PREV = yes
					}

					religion = jewish
					remove_province_modifier = secret_jewish_community
				}
			}
		}

		karaite = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_karaite_community
						held_under_PREV = yes
					}

					religion = karaite
					remove_province_modifier = secret_karaite_community
				}
			}
		}

		samaritan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_samaritan_community
						held_under_PREV = yes
					}

					religion = samaritan
					remove_province_modifier = secret_samaritan_community
				}
			}
		}

		zoroastrian = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_zoroastrian_community
						held_under_PREV = yes
					}

					religion = zoroastrian
					remove_province_modifier = secret_zoroastrian_community
				}
			}
		}

		mazdaki = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_mazdaki_community
						held_under_PREV = yes
					}

					religion = mazdaki
					remove_province_modifier = secret_mazdaki_community
				}
			}
		}

		manichaean = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_manichaean_community
						held_under_PREV = yes
					}

					religion = manichaean
					remove_province_modifier = secret_manichaean_community
				}
			}
		}

		khurmazta = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_khurmazta_community
						held_under_PREV = yes
					}

					religion = khurmazta
					remove_province_modifier = secret_khurmazta_community
				}
			}
		}

		bon_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_bon_pagan_community
						held_under_PREV = yes
					}

					religion = bon_pagan
					remove_province_modifier = secret_bon_pagan_community
				}
			}
		}

		bon_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_bon_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = bon_pagan_reformed
					remove_province_modifier = secret_bon_pagan_reformed_community
				}
			}
		}

		hellenic_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_hellenic_pagan_community
						held_under_PREV = yes
					}

					religion = hellenic_pagan
					remove_province_modifier = secret_hellenic_pagan_community
				}
			}
		}

		hellenic_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_hellenic_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = hellenic_pagan_reformed
					remove_province_modifier = secret_hellenic_pagan_reformed_community
				}
			}
		}

		taoist = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_taoist_community
						held_under_PREV = yes
					}

					religion = taoist
					remove_province_modifier = secret_taoist_community
				}
			}
		}

		hindu = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_hindu_community
						held_under_PREV = yes
					}

					religion = hindu
					remove_province_modifier = secret_hindu_community
				}
			}
		}

		buddhist = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_buddhist_community
						held_under_PREV = yes
					}

					religion = buddhist
					remove_province_modifier = secret_buddhist_community
				}
			}
		}

		jain = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_jain_community
						held_under_PREV = yes
					}

					religion = jain
					remove_province_modifier = secret_jain_community
				}
			}
		}

		norse_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_norse_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = norse_pagan_reformed
					remove_province_modifier = secret_norse_pagan_reformed_community
				}
			}
		}

		norse_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_norse_pagan_community
						held_under_PREV = yes
					}

					religion = norse_pagan
					remove_province_modifier = secret_norse_pagan_community
				}
			}
		}

		slavic_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_slavic_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = slavic_pagan_reformed
					remove_province_modifier = secret_slavic_pagan_reformed_community
				}
			}
		}

		slavic_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_slavic_pagan_community
						held_under_PREV = yes
					}

					religion = slavic_pagan
					remove_province_modifier = secret_slavic_pagan_community
				}
			}
		}

		tengri_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_tengri_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = tengri_pagan_reformed
					remove_province_modifier = secret_tengri_pagan_reformed_community
				}
			}
		}

		tengri_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_tengri_pagan_community
						held_under_PREV = yes
					}

					religion = tengri_pagan
					remove_province_modifier = secret_tengri_pagan_community
				}
			}
		}

		baltic_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_baltic_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = baltic_pagan_reformed
					remove_province_modifier = secret_baltic_pagan_reformed_community
				}
			}
		}

		baltic_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_baltic_pagan_community
						held_under_PREV = yes
					}

					religion = baltic_pagan
					remove_province_modifier = secret_baltic_pagan_community
				}
			}
		}

		finnish_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_finnish_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = finnish_pagan_reformed
					remove_province_modifier = secret_finnish_pagan_reformed_community
				}
			}
		}

		finnish_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_finnish_pagan_community
						held_under_PREV = yes
					}

					religion = finnish_pagan
					remove_province_modifier = secret_finnish_pagan_community
				}
			}
		}

		west_african_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_west_african_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = west_african_pagan_reformed
					remove_province_modifier = secret_west_african_pagan_reformed_community
				}
			}
		}

		west_african_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_west_african_pagan_community
						held_under_PREV = yes
					}

					religion = west_african_pagan
					remove_province_modifier = secret_west_african_pagan_community
				}
			}
		}

		zun_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_zun_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = zun_pagan_reformed
					remove_province_modifier = secret_zun_pagan_reformed_community
				}
			}
		}

		zun_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_zun_pagan_community
						held_under_PREV = yes
					}

					religion = zun_pagan
					remove_province_modifier = secret_zun_pagan_community
				}
			}
		}

		aztec_pagan = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_aztec_pagan_community
						held_under_PREV = yes
					}

					religion = aztec_pagan
					remove_province_modifier = secret_aztec_pagan_community
				}
			}
		}

		aztec_pagan_reformed = {
			top_liege = {
				any_realm_province = {
					limit = {
						has_province_modifier = secret_aztec_pagan_reformed_community
						held_under_PREV = yes
					}

					religion = aztec_pagan_reformed
					remove_province_modifier = secret_aztec_pagan_reformed_community
				}
			}
		}
	}
}

# TODO: Rework with persistent_event_target (religion scope)
root_secret_religion_provinces_convert_effect = {
	ROOT = {
		trigger_switch = {
			on_trigger = secret_religion

			catholic = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_catholic_community
							owned_by = PREV
						}

						religion = catholic
						remove_province_modifier = secret_catholic_community
					}
				}
			}

			cathar = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_cathar_community
							owned_by = PREV
						}

						religion = cathar
						remove_province_modifier = secret_cathar_community
					}
				}
			}

			fraticelli = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_fraticelli_community
							owned_by = PREV
						}

						religion = fraticelli
						remove_province_modifier = secret_fraticelli_community
					}
				}
			}

			waldensian = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_waldensian_community
							owned_by = PREV
						}

						religion = waldensian
						remove_province_modifier = secret_waldensian_community
					}
				}
			}

			lollard = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_lollard_community
							owned_by = PREV
						}

						religion = lollard
						remove_province_modifier = secret_lollard_community
					}
				}
			}

			orthodox = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_orthodox_community
							owned_by = PREV
						}

						religion = orthodox
						remove_province_modifier = secret_orthodox_community
					}
				}
			}

			miaphysite = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_miaphysite_community
							owned_by = PREV
						}

						religion = miaphysite
						remove_province_modifier = secret_miaphysite_community
					}
				}
			}

			monophysite = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_monophysite_community
							owned_by = PREV
						}

						religion = monophysite
						remove_province_modifier = secret_monophysite_community
					}
				}
			}

			bogomilist = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_bogomilist_community
							owned_by = PREV
						}

						religion = bogomilist
						remove_province_modifier = secret_bogomilist_community
					}
				}
			}

			monothelite = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_monothelite_community
							owned_by = PREV
						}

						religion = monothelite
						remove_province_modifier = secret_monothelite_community
					}
				}
			}

			iconoclast = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_iconoclast_community
							owned_by = PREV
						}

						religion = iconoclast
						remove_province_modifier = secret_iconoclast_community
					}
				}
			}

			paulician = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_paulician_community
							owned_by = PREV
						}

						religion = paulician
						remove_province_modifier = secret_paulician_community
					}
				}
			}

			nestorian = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_nestorian_community
							owned_by = PREV
						}

						religion = nestorian
						remove_province_modifier = secret_nestorian_community
					}
				}
			}

			messalian = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_messalian_community
							owned_by = PREV
						}

						religion = messalian
						remove_province_modifier = secret_messalian_community
					}
				}
			}

			sunni = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_sunni_community
							owned_by = PREV
						}

						religion = sunni
						remove_province_modifier = secret_sunni_community
					}
				}
			}

			zikri = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_zikri_community
							owned_by = PREV
						}

						religion = zikri
						remove_province_modifier = secret_zikri_community
					}
				}
			}

			yazidi = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_yazidi_community
							owned_by = PREV
						}

						religion = yazidi
						remove_province_modifier = secret_yazidi_community
					}
				}
			}

			ibadi = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_ibadi_community
							owned_by = PREV
						}

						religion = ibadi
						remove_province_modifier = secret_ibadi_community
					}
				}
			}

			kharijite = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_kharijite_community
							owned_by = PREV
						}

						religion = kharijite
						remove_province_modifier = secret_kharijite_community
					}
				}
			}

			shiite = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_shiite_community
							owned_by = PREV
						}

						religion = shiite
						remove_province_modifier = secret_shiite_community
					}
				}
			}

			druze = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_druze_community
							owned_by = PREV
						}

						religion = druze
						remove_province_modifier = secret_druze_community
					}
				}
			}

			hurufi = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hurufi_community
							owned_by = PREV
						}

						religion = hurufi
						remove_province_modifier = secret_hurufi_community
					}
				}
			}

			qarmatian = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_qarmatian_community
							owned_by = PREV
						}

						religion = qarmatian
						remove_province_modifier = secret_qarmatian_community
					}
				}
			}

			aztec_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_aztec_pagan_community
							owned_by = PREV
						}

						religion = aztec_pagan
						remove_province_modifier = secret_aztec_pagan_community
					}
				}
			}

			aztec_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_aztec_pagan_reformed_community
							owned_by = PREV
						}

						religion = aztec_pagan_reformed
						remove_province_modifier = secret_aztec_pagan_reformed_community
					}
				}
			}

			jewish = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_jewish_community
							owned_by = PREV
						}

						religion = jewish
						remove_province_modifier = secret_jewish_community
					}
				}
			}

			samaritan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_samaritan_community
							owned_by = PREV
						}

						religion = samaritan
						remove_province_modifier = secret_samaritan_community
					}
				}
			}

			karaite = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_karaite_community
							owned_by = PREV
						}

						religion = karaite
						remove_province_modifier = secret_karaite_community
					}
				}
			}

			zoroastrian = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_zoroastrian_community
							owned_by = PREV
						}

						religion = zoroastrian
						remove_province_modifier = secret_zoroastrian_community
					}
				}
			}

			mazdaki = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_mazdaki_community
							owned_by = PREV
						}

						religion = mazdaki
						remove_province_modifier = secret_mazdaki_community
					}
				}
			}

			manichaean = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_manichaean_community
							owned_by = PREV
						}

						religion = manichaean
						remove_province_modifier = secret_manichaean_community
					}
				}
			}

			khurmazta = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_khurmazta_community
							owned_by = PREV
						}

						religion = khurmazta
						remove_province_modifier = secret_khurmazta_community
					}
				}
			}

			bon_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_bon_pagan_community
							owned_by = PREV
						}

						religion = bon_pagan
						remove_province_modifier = secret_bon_pagan_community
					}
				}
			}

			bon_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_bon_pagan_reformed_community
							owned_by = PREV
						}

						religion = bon_pagan_reformed
						remove_province_modifier = secret_bon_pagan_reformed_community
					}
				}
			}

			hellenic_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hellenic_pagan_community
							owned_by = PREV
						}

						religion = hellenic_pagan
						remove_province_modifier = secret_hellenic_pagan_community
					}
				}
			}

			hellenic_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hellenic_pagan_reformed_community
							owned_by = PREV
						}

						religion = hellenic_pagan_reformed
						remove_province_modifier = secret_hellenic_pagan_reformed_community
					}
				}
			}

			taoist = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_taoist_community
							owned_by = PREV
						}

						religion = taoist
						remove_province_modifier = secret_taoist_community
					}
				}
			}

			hindu = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hindu_community
							owned_by = PREV
						}

						religion = hindu
						remove_province_modifier = secret_hindu_community
					}
				}
			}

			buddhist = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_buddhist_community
							owned_by = PREV
						}

						religion = buddhist
						remove_province_modifier = secret_buddhist_community
					}
				}
			}

			jain = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_jain_community
							owned_by = PREV
						}

						religion = jain
						remove_province_modifier = secret_jain_community
					}
				}
			}

			norse_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_norse_pagan_reformed_community
							owned_by = PREV
						}

						religion = norse_pagan_reformed
						remove_province_modifier = secret_norse_pagan_reformed_community
					}
				}
			}

			norse_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_norse_pagan_community
							owned_by = PREV
						}

						religion = norse_pagan
						remove_province_modifier = secret_norse_pagan_community
					}
				}
			}

			slavic_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_slavic_pagan_reformed_community
							owned_by = PREV
						}

						religion = slavic_pagan_reformed
						remove_province_modifier = secret_slavic_pagan_reformed_community
					}
				}
			}

			slavic_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_slavic_pagan_community
							owned_by = PREV
						}

						religion = slavic_pagan
						remove_province_modifier = secret_slavic_pagan_community
					}
				}
			}

			tengri_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_tengri_pagan_reformed_community
							owned_by = PREV
						}

						religion = tengri_pagan_reformed
						remove_province_modifier = secret_tengri_pagan_reformed_community
					}
				}
			}

			tengri_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_tengri_pagan_community
							owned_by = PREV
						}

						religion = tengri_pagan
						remove_province_modifier = secret_tengri_pagan_community
					}
				}
			}

			baltic_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_baltic_pagan_reformed_community
							owned_by = PREV
						}

						religion = baltic_pagan_reformed
						remove_province_modifier = secret_baltic_pagan_reformed_community
					}
				}
			}

			baltic_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_baltic_pagan_community
							owned_by = PREV
						}

						religion = baltic_pagan
						remove_province_modifier = secret_baltic_pagan_community
					}
				}
			}

			finnish_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_finnish_pagan_reformed_community
							owned_by = PREV
						}

						religion = finnish_pagan_reformed
						remove_province_modifier = secret_finnish_pagan_reformed_community
					}
				}
			}

			finnish_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_finnish_pagan_community
							owned_by = PREV
						}

						religion = finnish_pagan
						remove_province_modifier = secret_finnish_pagan_community
					}
				}
			}

			west_african_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_west_african_pagan_reformed_community
							owned_by = PREV
						}

						religion = west_african_pagan_reformed
						remove_province_modifier = secret_west_african_pagan_reformed_community
					}
				}
			}

			west_african_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_west_african_pagan_community
							owned_by = PREV
						}

						religion = west_african_pagan
						remove_province_modifier = secret_west_african_pagan_community
					}
				}
			}

			zun_pagan_reformed = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_zun_pagan_reformed_community
							owned_by = PREV
						}

						religion = zun_pagan_reformed
						remove_province_modifier = secret_zun_pagan_reformed_community
					}
				}
			}

			zun_pagan = {
				PREV = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_zun_pagan_community
							owned_by = PREV
						}

						religion = zun_pagan
						remove_province_modifier = secret_zun_pagan_community
					}
				}
			}
		}
	}
}

# Referenced by Alternate Start religion feature generation
reset_religion_features_effect = {
	set_peace_piety_gain = 0
	set_pacifist = no
	set_convert_other_groups = 2
	set_convert_same_group = 2
	set_peace_prestige_loss = no
	set_ai_aggression = 1
	set_unit_modifier = { }
	set_unit_home_modifier = { }
	set_hard_to_convert = no
	set_raised_vassal_opinion_loss = yes
	set_piety_loss_for_attacking_same_religion = no
	set_max_wives = 1
	set_max_consorts = 0
	set_feminist = no
	set_heir_designation = no
	set_short_reign_opinion_year_mult = -1000
	set_jizya_tax = no
	set_can_retire_to_monastery = no
	set_can_excommunicate = no
	set_can_grant_divorce = no
	set_can_grant_invasion_cb = no
	set_can_grant_claim = no
	set_can_call_crusade = no
	set_pc_marriage = no
	set_bs_marriage = no
	set_psc_marriage = yes
	set_cousin_marriage = yes
	set_seafaring = no
	set_allow_looting = no
	set_allow_rivermovement = no
	set_autocephaly = no
	set_pentarchy = no
	set_divine_blood = no
	set_uses_decadence = no
	set_can_have_antipopes = no
	set_priests_can_marry = no
	set_priests_can_inherit = yes
	set_ignores_defensive_attrition = no
	set_defensive_attrition = no
	clear_intermarry = no
	set_character_modifier = { }
	clear_intermarry = yes
	set_allows_matrilineal_marriage = yes
}

apply_cosmopolian_on_start_effect = {
	religion_authority = {
		name = cosmopolitan_religion
		years = 1000
	}

	any_playable_ruler = {
		limit = {
			distance_from_realm = {
				who = ROOT
				value < 200
			}
		}

		add_intermarry = ROOT
		ROOT = { add_intermarry = PREV }
	}

	any_neighbor_independent_ruler = {
		add_intermarry = ROOT
		ROOT = { add_intermarry = PREV }
	}
}

apply_dogmatic_on_start_effect = {
	religion_authority = {
		name = dogmatic_religion
		years = 1000
	}

	remove_intermarry = pagan_group
	remove_intermarry = zoroastrian_group
	remove_intermarry = christian
	remove_intermarry = muslim
	remove_intermarry = indian_group
	remove_intermarry = jewish_group
}

# Reforming religion with certain Doctrines might result in gods being added/removed/changed
reformation_god_names_changes_effect = {
	ROOT = { # Reformer
		if = {
			limit = {
				has_dlc = "Holy Fury"

				NOT = {
					has_alternate_start_parameter = {
						key = religion_names
						value = random
					}
				}
			}

			if = { # A ruler reforms Norse Paganism
				limit = {
					religion = norse_pagan_reformed

					OR = {
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_patriarchal
						has_religion_feature = religion_dogmatic
					}
				}

				remove_god_names = yes
				remove_evil_god_names = yes

				if = { # Religion is Patriarchal
					limit = { has_religion_feature = religion_patriarchal }

					set_high_god_name = GOD_ODIN
					add_god_name = GOD_ODIN_2

					if = {
						limit = {
							NOT = { has_religion_feature = religion_dogmatic }
						}

						add_god_name = GOD_THOR
						add_god_name = GOD_THE_THUNDERER
						add_god_name = GOD_THE_ALLFATHER
						add_god_name = GOD_TYR
					}

					add_evil_god_name = GOD_FRIGG
					add_evil_god_name = HEL
					add_evil_god_name = GOD_SIF
					add_evil_god_name = GOD_SKADI
				}

				else_if = { # Religion is Matriarchal
					limit = { has_religion_feature = religion_matriarchal }
					set_high_god_name = GOD_FRIGG
					add_god_name = GOD_FRIGG_2

					if = {
						limit = {
							NOT = { has_religion_feature = religion_dogmatic }
						}

						add_god_name = GOD_SIF
						add_god_name = GOD_THE_ALLMOTHER
						add_god_name = GOD_SKADI
						add_god_name = GOD_FREY
					}

					add_evil_god_name = LOKI
					add_evil_god_name = GOD_THE_THUNDERER
					add_evil_god_name = FENRIR
					add_evil_god_name = JORMUNGANDR
				}

				else = { # Religion is not sexist, add just Dogmatic set
					set_high_god_name = GOD_THE_ALLFATHER
					add_god_name = GOD_THE_ALLFATHER_2
					add_evil_god_name = LOKI
					add_evil_god_name = HEL
					add_evil_god_name = FENRIR
					add_evil_god_name = JORMUNGANDR
				}
			}

			else_if = { # A ruler reforms Tengri Paganism
				limit = {
					religion = tengri_pagan_reformed

					OR = {
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_patriarchal
						has_religion_feature = religion_dogmatic
					}
				}

				remove_god_names = yes
				remove_evil_god_names = yes

				if = { # Religion is Patriarchal
					limit = { has_religion_feature = religion_patriarchal }

					set_high_god_name = GOD_TENGRI
					add_god_name = GOD_TENGRI_2
					add_god_name = GOD_TUNG-AK
					add_evil_god_name = GOD_AK_ANA
					add_evil_god_name = KOMUR_HAN
				}

				else_if = { # Religion is Matriarchal
					limit = { has_religion_feature = religion_matriarchal }

					set_high_god_name = GOD_UMAY
					add_god_name = GOD_UMAY_2
					add_god_name = GOD_AK_ANA
					add_god_name = GOD_KUBAI
					add_evil_god_name = ERLIK
					add_evil_god_name = KOMUR_HAN
				}

				else = { # Religion is not sexist, add just Dogmatic set
					set_high_god_name = GOD_TENGRI
					add_god_name = GOD_TENGRI_2
					add_evil_god_name = ERLIK
					add_evil_god_name = KOMUR_HAN
				}
			}

			else_if = { # A ruler reforms Baltic Paganism
				limit = {
					religion = baltic_pagan_reformed

					OR = {
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_patriarchal
						has_religion_feature = religion_dogmatic
					}
				}

				remove_god_names = yes
				remove_evil_god_names = yes

				if = { # Religion is Patriarchal
					limit = { has_religion_feature = religion_patriarchal }

					set_high_god_name = GOD_DIEVAS
					add_god_name = GOD_DIEVAS_2
					add_god_name = GOD_PERKUNAS
					add_evil_god_name = GOD_LAIMA
				}

				else_if = { # Religion is Matriarchal
					limit = { has_religion_feature = religion_matriarchal }

					set_high_god_name = GOD_GABIJA
					add_god_name = GOD_GABIJA_2
					add_god_name = GOD_LAIMA
					add_evil_god_name = VELNIAS
				}

				else = { # Religion is not sexist, add just Dogmatic set
					set_high_god_name = GOD_DIEVAS
					add_god_name = GOD_DIEVAS_2
					add_evil_god_name = VELNIAS
				}
			}

			else_if = { # A ruler reforms Finnish Paganism
				limit = {
					religion = finnish_pagan_reformed

					OR = {
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_patriarchal
						has_religion_feature = religion_dogmatic
					}
				}

				remove_god_names = yes
				remove_evil_god_names = yes

				if = { # Religion is Patriarchal
					limit = { has_religion_feature = religion_patriarchal }

					set_high_god_name = GOD_UKKO
					add_god_name = GOD_UKKO_2

					if = {
						limit = {
							NOT = { has_religion_feature = religion_dogmatic }
						}

						add_god_name = GOD_PERKELE
						add_god_name = GOD_JUMI
						add_god_name = GOD_THE_GREAT_BEAR
						add_god_name = GOD_TAPIO
						add_god_name = GOD_TAARA
						add_god_name = GOD_OMOL
					}

					add_evil_god_name = GOD_MASTOR_AVA
					add_evil_god_name = GOD_KALMA
				}

				else_if = { # Religion is Matriarchal
					limit = { has_religion_feature = religion_matriarchal }

					set_high_god_name = GOD_KUU
					add_god_name = GOD_KUU_2

					if = {
						limit = {
							NOT = { has_religion_feature = religion_dogmatic }
						}

						add_god_name = GOD_MASTOR_AVA
						add_god_name = GOD_KALMA
						add_god_name = GOD_THE_GREAT_BEAR
					}

					add_evil_god_name = TUONI
					add_evil_god_name = TUONETAR
				}

				else = { # Religion is not sexist, add just Dogmatic set
					set_high_god_name = GOD_UKKO
					add_god_name = GOD_UKKO_2
					add_evil_god_name = TUONI
				}
			}

			else_if = { # A ruler reforms Aztec Paganism
				limit = {
					religion = aztec_pagan_reformed

					OR = {
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_patriarchal
						has_religion_feature = religion_dogmatic
						has_religion_feature = religion_proselytizing
					}
				}

				remove_god_names = yes
				remove_evil_god_names = yes

				if = { # Religion is Patriarchal
					limit = { has_religion_feature = religion_patriarchal }

					set_high_god_name = GOD_HUITZILOPOCHTLI
					add_god_name = GOD_HUITZILOPOCHTLI_2
					add_god_name = GOD_XIPE_TOTEC
					add_god_name = GOD_TEZCATLIPOCA
					add_god_name = GOD_QUETZALCOATL
					add_god_name = GOD_TLALOC
					add_evil_god_name = TLAZOLTEOTL
					add_evil_god_name = GOD_MICTLANTECUHTLI
					add_evil_god_name = XOLOTL
				}

				else_if = { # Religion is Matriarchal
					limit = { has_religion_feature = religion_matriarchal }

					set_high_god_name = GOD_CIHUACOATL
					add_god_name = GOD_CIHUACOATL_2
					add_god_name = GOD_MALINALXOCHITL
					add_god_name = GOD_METZTLI
					add_god_name = GOD_TONACACIHUATL
					add_evil_god_name = TLAZOLTEOTL
					add_evil_god_name = GOD_MICTLANTECUHTLI
					add_evil_god_name = XOLOTL
				}

				else = { # Religion is not sexist
					if = { # add just Proselytizing set
						limit = { has_religion_feature = religion_proselytizing }

						set_high_god_name = GOD_QUETZALCOATL
						add_god_name = GOD_QUETZALCOATL_2
						add_evil_god_name = GOD_TEZCATLIPOCA
					}
					else_if = { # add just Dogmatic set
						limit = { has_religion_feature = religion_dogmatic 	}

						set_high_god_name = GOD_HUITZILOPOCHTLI
						add_god_name = GOD_HUITZILOPOCHTLI_2
						add_evil_god_name = TLAZOLTEOTL
					}
				}
			}

			else_if = { # A ruler reforms Slavic Paganism
				limit = {
					religion = slavic_pagan_reformed

					OR = {
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_patriarchal
						has_religion_feature = religion_dogmatic
					}
				}

				remove_god_names = yes
				remove_evil_god_names = yes

				if = { # Religion is Patriarchal
					limit = { has_religion_feature = religion_patriarchal }

					set_high_god_name = GOD_PERUN
					add_god_name = GOD_PERUN_2

					if = {
						limit = {
							NOT = { has_religion_feature = religion_dogmatic }
						}

						add_god_name = GOD_JARILO
						add_god_name = GOD_SVAROG
						add_god_name = GOD_TRIGLAV
						add_god_name = GOD_RADEGAST
					}

					add_evil_god_name = GOD_VELES
					add_evil_god_name = GOD_MEDEINA
				}

				else_if = { # Religion is Matriarchal
					limit = { has_religion_feature = religion_matriarchal }

					set_high_god_name = GOD_MEDEINA
					add_god_name = GOD_MEDEINA_2

					if = {
						limit = {
							NOT = { has_religion_feature = religion_dogmatic }
						}

						add_god_name = GOD_DODOLA
						add_god_name = GOD_KOSTROMA
						add_god_name = GOD_MARZANNA
					}

					add_evil_god_name = GOD_VELES
					add_evil_god_name = CHERNOBOG
				}

				else = { # Religion is not sexist, add just Dogmatic set
					set_high_god_name = GOD_PERUN
					add_god_name = GOD_PERUN_2
					add_evil_god_name = GOD_VELES
					add_evil_god_name = CHERNOBOG
				}
			}

			else_if = { # A ruler reforms African Paganism
				limit = {
					religion = west_african_pagan_reformed
					has_religion_feature = religion_matriarchal
				}
				set_high_god_name = GOD_THE_MOTHER
			}

			else_if = { # A ruler reforms Bon Paganism
				limit = {
					religion = bon_pagan_reformed
					has_religion_feature = religion_dogmatic
				}

				remove_god_names = yes
				set_high_god_name = GOD_SANGPO_BUMTRI
				add_god_name = GOD_SANGPO_BUMTRI_2
				add_evil_god_name = GOD_THE_EVIL_ONES
			}

			else_if = { # A ruler reforms Hellenism
				limit = { religion = hellenic_pagan_reformed }

				if = { # while being Greek-cultured: change all the gods to their Greek names
					limit = { culture = greek }

					remove_god_names = yes
					remove_evil_god_names = yes
					set_global_flag = flag_hellenic_greek_reformation # Handles other instances

					if = { # Religion is Patriarchal
						limit = { has_religion_feature = religion_patriarchal }

						if = { # Poseidon finally gets his due
							limit = { has_religion_feature = religion_seafaring }
							set_high_god_name = GOD_POSEIDON
						}
						else = {
							set_high_god_name = GOD_GREEK_JUPITER # Otherwise shows Conclave...
						}

						if = { # Dogmatics only get one
							limit = {
								NOT = { has_religion_feature = religion_dogmatic }
							}

							add_god_name = GOD_GREEK_JUPITER_2 # Otherwise shows Conclave...
							add_god_name = GOD_POSEIDON_2
							add_god_name = GOD_HADES
							add_god_name = GOD_ARES
							add_god_name = GOD_HEPHAESTUS
							add_god_name = GOD_APOLLO
						}

						add_evil_god_name = GOD_APHRODITE
						add_evil_god_name = GOD_HERA
						add_evil_god_name = GOD_ATHENA
						add_evil_god_name = GOD_ARTEMIS
						add_evil_god_name = GOD_DELFINE
					}

					else_if = { # Religion is Matriarchal
						limit = { has_religion_feature = religion_matriarchal }

						set_high_god_name = GOD_HERA
						add_god_name = GOD_HERA_2

						if = { # Dogmatics only get one
							limit = {
								NOT = { has_religion_feature = religion_dogmatic }
							}

							add_god_name = GOD_DEMETRA
							add_god_name = GOD_ATHENA
							add_god_name = GOD_APHRODITE
							add_god_name = GOD_ARTEMIS
							add_god_name = GOD_HESTIA
						}

						add_evil_god_name = GOD_HADES
						add_evil_god_name = GOD_GREEK_JUPITER # Otherwise shows Conclave...
						add_evil_god_name = GOD_POSEIDON
						add_evil_god_name = GOD_ARES
						add_evil_god_name = GOD_TYPHON
					}

					else = { # Religion is not sexist, re-add all the gods
						if = { # Poseidon finally gets his due
							limit = { has_religion_feature = religion_seafaring }
							set_high_god_name = GOD_POSEIDON
						}
						else = {
							set_high_god_name = GOD_GREEK_JUPITER # Otherwise shows Conclave...
						}

						if = { # Dogmatics only get one
							limit = {
								NOT = { has_religion_feature = religion_dogmatic }
							}

							add_god_name = GOD_GREEK_JUPITER_2 # Otherwise shows Conclave...
							add_god_name = GOD_POSEIDON_2
							add_god_name = GOD_HADES
							add_god_name = GOD_HERA
							add_god_name = GOD_DEMETRA
							add_god_name = GOD_ATHENA
							add_god_name = GOD_ARES
							add_god_name = GOD_HEPHAESTUS
							add_god_name = GOD_APHRODITE
							add_god_name = GOD_APOLLO
							add_god_name = GOD_ARTEMIS
							add_god_name = GOD_HESTIA
						}

						add_evil_god_name = GOD_HADES
						add_evil_god_name = GOD_KRONOS
						add_evil_god_name = GOD_DIONYSUS
						add_evil_god_name = GOD_HERMES
						add_evil_god_name = GOD_TYPHON
					}
				}

				else = { # while NOT being Greek-cultured
					remove_god_names = yes
					remove_evil_god_names = yes

					if = { # Religion is Patriarchal
						limit = { has_religion_feature = religion_patriarchal }

						if = { # Poseidon finally gets his due
							limit = { has_religion_feature = religion_seafaring }
							set_high_god_name = GOD_NEPTUNE
						}

						else = {
							set_high_god_name = GOD_JUPITER
						}

						if = { # Dogmatics only get one
							limit = {
								NOT = { has_religion_feature = religion_dogmatic }
							}

							add_god_name = GOD_JUPITER_2
							add_god_name = GOD_NEPTUNE_2
							add_god_name = GOD_PLUTO
							add_god_name = GOD_MARS
							add_god_name = GOD_VULCAN
							add_god_name = GOD_APOLLO
						}

						add_evil_god_name = GOD_VENUS
						add_evil_god_name = GOD_JUNO
						add_evil_god_name = GOD_MINERVA
						add_evil_god_name = GOD_DIANA
						add_evil_god_name = GOD_DELFINE
					}

					else_if = { # Religion is Matriarchal
						limit = { has_religion_feature = religion_matriarchal }

						set_high_god_name = GOD_JUNO
						add_god_name = GOD_JUNO_2

						if = { # Dogmatics only get one
							limit = {
								NOT = { has_religion_feature = religion_dogmatic }
							}

							add_god_name = GOD_CERES
							add_god_name = GOD_MINERVA
							add_god_name = GOD_VENUS
							add_god_name = GOD_DIANA
							add_god_name = GOD_VESTA
						}

						add_evil_god_name = GOD_PLUTO
						add_evil_god_name = GOD_JUPITER
						add_evil_god_name = GOD_NEPTUNE
						add_evil_god_name = GOD_MARS
						add_evil_god_name = GOD_TYPHON
					}

					else = { # Religion is not sexist, re-add all the gods
						if = { # Poseidon finally gets his due
							limit = { has_religion_feature = religion_seafaring }
							set_high_god_name = GOD_NEPTUNE
						}
						else = {
							set_high_god_name = GOD_JUPITER
						}

						if = { # Dogmatics only get one
							limit = {
								NOT = { has_religion_feature = religion_dogmatic }
							}

							add_god_name = GOD_JUPITER_2
							add_god_name = GOD_NEPTUNE_2
							add_god_name = GOD_PLUTO
							add_god_name = GOD_JUNO
							add_god_name = GOD_CERES
							add_god_name = GOD_MINERVA
							add_god_name = GOD_MARS
							add_god_name = GOD_VULCAN
							add_god_name = GOD_VENUS
							add_god_name = GOD_APOLLO
							add_god_name = GOD_DIANA
							add_god_name = GOD_VESTA
						}

						add_evil_god_name = GOD_SATURN
						add_evil_god_name = GOD_PLUTO
						add_evil_god_name = GOD_BACCHUS
						add_evil_god_name = GOD_MERCURY
						add_evil_god_name = GOD_TYPHON
					}
				}
			}
		}

		if = {
			limit = { # Holy Family actually becomes Holy
				OR = {
					has_religion_feature = religion_holy_family
					has_religion_feature = religion_feature_zun
				}
			}

			if = {
				limit = { # Reformer himself, but only if he is not becoming the High God due to synergy
					NOT = { has_religion_feature = religion_temporal_head }

					trigger_if = {
						limit = { is_female = no }
						NOT = { has_religion_feature = religion_matriarchal }
					}
					trigger_else = {
						NOT = { has_religion_feature = religion_patriarchal }
					}
				}

				add_god_name = string_reformer_god
			}

			if = { # Spouse
				limit = { is_married = yes }

				random_spouse = { save_event_target_as = scoped_god_spouse }

				if = {
					limit = {
						trigger_if = {
							limit = { is_female = yes }
							NOT = { has_religion_feature = religion_matriarchal }
						}
						trigger_else = {
							NOT = { has_religion_feature = religion_patriarchal }
						}
					}

					add_god_name = string_reformer_spouse_god
				}
				else = {
					add_evil_god_name = string_reformer_spouse_god
				}
			}

			if = {
				limit = { # Child
					any_child = {
						trigger_if = {
							limit = { is_female = no }

							ROOT = {
								NOT = { has_religion_feature = religion_matriarchal }
							}
						}
						trigger_else = {
							ROOT = {
								NOT = { has_religion_feature = religion_patriarchal }
							}
						}
					}
				}

				random_child = {
					limit = {
						trigger_if = {
							limit = { is_female = no }

							ROOT = {
								NOT = { has_religion_feature = religion_matriarchal }
							}
						}
						trigger_else = {
							ROOT = {
								NOT = { has_religion_feature = religion_patriarchal }
							}
						}
					}

					preferred_limit = {
						is_primary_heir = ROOT
					}

					save_event_target_as = scoped_god_child
				}

				add_god_name = string_reformer_child_god
			}

			if = {
				limit = { # Sibling
					any_sibling = {
						trigger_if = {
							limit = { is_female = no }

							ROOT = {
								NOT = { has_religion_feature = religion_matriarchal }
							}
						}
						trigger_else = {
							ROOT = {
								NOT = { has_religion_feature = religion_patriarchal }
							}
						}
					}
				}

				random_sibling = {
					limit = {
						trigger_if = {
							limit = { is_female = no }

							ROOT = {
								NOT = { has_religion_feature = religion_matriarchal }
							}
						}
						trigger_else = {
							ROOT = {
								NOT = { has_religion_feature = religion_patriarchal }
							}
						}
					}

					preferred_limit = {
						is_primary_heir = ROOT
					}

					save_event_target_as = scoped_god_sibling
				}

				add_god_name = string_reformer_sibling_god
			}
		}

		if = {
			limit = { # Reformer becomes the High God
				OR = {
					has_religion_feature = religion_holy_family
					has_religion_feature = religion_feature_zun
				}

				has_religion_feature = religion_temporal_head
			}

			set_high_god_name = string_reformer_god
		}
	}
}

convert_religion_failsafe_effect = {
	hidden_effect = {
		if = {
			limit = {
				trigger_if = {
					limit = { is_theocracy = yes }
					is_ruler = yes
				}
				# Potentially no longer allowed to hold temples and would become a theocracy
				trigger_else = {
					capital_holding = { holding_type = temple }

					OR = {
						government = muslim_government
						government = theocratic_feudal_government
					}

					NOT = {
						any_demesne_title = {
							real_tier = BARON
							is_preferred_holding_type = PREV
						}
					}
				}
			}

			set_character_flag = needs_temporary_fake_theocracy_government
			set_government_type = temporary_fake_theocracy_government
		}
	}

	trigger_switch = {
		on_trigger = has_character_flag

		convert_secret = {
			convert_to_secret_religion = yes
			clr_character_flag = convert_secret
		}

		convert_heretic = {
			if = {
				limit = { ai = no }
				become_heretic = yes
			}
			else = {
				heresy_character_effect = yes
			}

			clr_character_flag = convert_heretic
		}

		convert_abandon_heresy = {
			abandon_heresy = yes
			clr_character_flag = convert_abandon_heresy
		}

		fallback = {
			if = {
				limit = { can_change_religion = yes }
				religion = event_target:target_religion
			}
			else = {
				unsafe_religion = event_target:target_religion
			}
			clear_event_target = target_religion
		}
	}

	hidden_effect = {
		if = {
			limit = { government = temporary_fake_theocracy_government }

			# Stop apostates from becoming a false religious head
			trigger_switch = {
				on_trigger = has_minor_title

				title_cardinal = { remove_title = title_cardinal }
				title_fraticelli_cardinal = { remove_title = title_fraticelli_cardinal }
				title_bogomilist_advisor = { remove_title = title_bogomilist_advisor }
				title_cathar_deacon = { remove_title = title_cathar_deacon }
				title_chalcedonian_cardinal = { remove_title = title_chalcedonian_cardinal }
				title_druid_circle_member = { remove_title = title_druid_circle_member }
				title_manichaean_apostle = { remove_title = title_manichaean_apostle }
				title_hellenic_pontiff = { remove_title = title_hellenic_pontiff }
			}

			# Check if my new religion even has theocracies
			if = {
				limit = {
					NOR = {
						is_government_potential = muslim_government
						is_government_potential = theocratic_feudal_government
					}
				}

				# Check if my new religion allows me to remain a priest
				if = {
					limit = {
						trigger_if = {
							limit = { is_female = no }
							religion_allows_male_temple_holders = yes
						}
						trigger_else = {
							religion_allows_female_temple_holders = yes
						}
					}

					# Check if my new religion allows me to remain married
					if = {
						limit = {
							# TODO: Replace with flag on religions
							OR = {
								religion_group = christian
								religion_group = zoroastrian_group
								religion_openly_bon_or_reformed_trigger = yes
								religion = jain
								religion = buddhist
								religion = taoist
							}
						}

						any_spouse = { remove_spouse = PREV }
						any_consort = { remove_consort = PREV }
					}

					set_correct_theocratic_government_type_effect = yes
				}
				else = {
					# Abdicate
					random_courtier = {
						limit = {
							religion = PREV
							is_opposite_sex = PREV
							is_ruler = no

							trigger_if = {
								limit = { has_dharmic_religion_trigger = yes }
								trait = brahmin
							}

							trigger_if = {
								limit = {
									OR = {
										religion_group = christian
										religion_group = zoroastrian_group
										religion_openly_bon_or_reformed_trigger = yes
										religion = jain
										religion = buddhist
										religion = taoist
									}
								}

								is_married = no
								is_consort = no
								is_senior_consort_party = no
							}

							NOR = {
								any_heir_title = { always = yes }
								any_pretender_title = { always = yes }
							}
						}

						save_event_target_as = new_priest
					}

					if = {
						limit = {
							NOT = { event_target:new_priest = { always = yes } }
						}

						if = {
							limit = { religion_allows_female_temple_holders = yes }

							create_random_priest = {
								random_traits = yes
								religion = THIS
								culture = THIS
								female = yes
							}
						}
						else = {
							create_random_priest = {
								random_traits = yes
								religion = THIS
								culture = THIS
								female = no
							}
						}

						new_character = {
							save_event_target_as = new_priest

							if = {
								limit = { has_dharmic_religion_trigger = yes }
								add_trait = brahmin
								character_event = { id = RoI.30120 } # Pick random sect
							}
						}
					}

					# Abdication effects leave undesirable claims
					any_demesne_title = {
						gain_title = event_target:new_priest
					}

					transfer_scaled_wealth = {
						to = event_target:new_priest
						value = all
					}

					# TODO: Transfer artifacts?

					clear_event_target = new_priest
				}
			}
			else = {
				set_correct_feudal_government_type_effect = yes
			}

			# Clear this flag, so that characters are forced into a normal government
			# Characters who have abdicated may take a day to find their way back into a court and get a suitable government
			clr_character_flag = needs_temporary_fake_theocracy_government
		}
	}
}

abdicate_all_primary_type_titles_effect = {
	if = {
		limit = { controls_religion = yes }

		# Secular religious head titles are forfeit
		if = {
			limit = { is_theocracy = no }

			any_demesne_title = {
				limit = { controls_religion = yes }
				destroy_landed_title = THIS
			}
		}

		# Theocratic religious head titles are given to a random new character
		else = {
			hidden_effect = {
				liege = {
					save_event_target_as = liege_target
				}
			}

			any_demesne_title = {
				show_scope_change = no

				limit = { controls_religion = yes }

				hidden_effect = {
					create_character = {
						age = 38
						dynasty = random
						religion = ROOT
						culture = ROOT
						random_traits = yes
					}
				}

				grant_title = new_character

				holder_scope = {
					show_scope_change = no

					any_vassal = {
						show_scope_change = no

						set_defacto_liege = event_target:liege_target
					}
				}
			}

			hidden_effect = {
				set_defacto_liege = event_target:liege_target
			}
		}
	}

	if = { # Holy Orders/Static Mercs are given to a random new character
		limit = {
			OR = {
				holy_order = yes
				mercenary = yes
			}
		}

		hidden_effect = {
			liege = {
				save_event_target_as = liege_target
			}
		}

		any_demesne_title = {
			show_scope_change = no

			limit = {
				OR = {
					holy_order = yes
					mercenary = yes
				}
			}

			hidden_effect = {
				create_character = {
					age = 38
					dynasty = random
					religion = PREV
					culture = PREV
					random_traits = yes
				}
			}

			grant_title = new_character

			holder_scope = {
				show_scope_change = no

				any_vassal = {
					show_scope_change = no

					set_defacto_liege = event_target:liege_target
				}
			}
		}

		hidden_effect = {
			set_defacto_liege = event_target:liege_target
		}
	}
}